import{_ as s,c as a,o as n,a as l}from"./app.c4aa1f4f.js";const F=JSON.parse('{"title":"git 提交规范","description":"","frontmatter":{},"headers":[{"level":2,"title":"【分支规范】","slug":"【分支规范】","link":"#【分支规范】","children":[]},{"level":2,"title":"永久分支","slug":"永久分支","link":"#永久分支","children":[]},{"level":2,"title":"Master/Devlop","slug":"master-devlop","link":"#master-devlop","children":[]},{"level":2,"title":"临时分支","slug":"临时分支","link":"#临时分支","children":[{"level":3,"title":"Feature 功能","slug":"feature-功能","link":"#feature-功能","children":[]},{"level":3,"title":"Release 预发布","slug":"release-预发布","link":"#release-预发布","children":[]},{"level":3,"title":"Hotfix 分支","slug":"hotfix-分支","link":"#hotfix-分支","children":[]}]},{"level":2,"title":"示例","slug":"示例","link":"#示例","children":[{"level":3,"title":"Develop 开发分支","slug":"develop-开发分支","link":"#develop-开发分支","children":[]},{"level":3,"title":"Feature 功能开发","slug":"feature-功能开发","link":"#feature-功能开发","children":[]},{"level":3,"title":"Release 预发布","slug":"release-预发布-1","link":"#release-预发布-1","children":[]},{"level":3,"title":"Hotfix 修复 bug","slug":"hotfix-修复-bug","link":"#hotfix-修复-bug","children":[]}]},{"level":2,"title":"【commit 规范】","slug":"【commit-规范】","link":"#【commit-规范】","children":[{"level":3,"title":"husky","slug":"husky","link":"#husky","children":[]},{"level":3,"title":"commitlint","slug":"commitlint","link":"#commitlint","children":[]},{"level":3,"title":"commitizen","slug":"commitizen","link":"#commitizen","children":[]},{"level":3,"title":"提交中支持表情符号","slug":"提交中支持表情符号","link":"#提交中支持表情符号","children":[]},{"level":3,"title":"自动生成 changelog","slug":"自动生成-changelog","link":"#自动生成-changelog","children":[]}]},{"level":2,"title":"git 命令","slug":"git-命令","link":"#git-命令","children":[{"level":3,"title":"关联远程分支","slug":"关联远程分支","link":"#关联远程分支","children":[]},{"level":3,"title":"设置远程分支","slug":"设置远程分支","link":"#设置远程分支","children":[]},{"level":3,"title":"查看分支","slug":"查看分支","link":"#查看分支","children":[]},{"level":3,"title":"删除远程分支","slug":"删除远程分支","link":"#删除远程分支","children":[]},{"level":3,"title":"拉取指定分支代码","slug":"拉取指定分支代码","link":"#拉取指定分支代码","children":[]},{"level":3,"title":"查看远程分支","slug":"查看远程分支","link":"#查看远程分支","children":[]},{"level":3,"title":"查看日志","slug":"查看日志","link":"#查看日志","children":[]},{"level":3,"title":"撤销操作","slug":"撤销操作","link":"#撤销操作","children":[]}]}],"relativePath":"front/eng/git提交规范.md","lastUpdated":1673417607000}'),p={name:"front/eng/git提交规范.md"},e=l(`<h1 id="git-提交规范" tabindex="-1">git 提交规范 <a class="header-anchor" href="#git-提交规范" aria-hidden="true">#</a></h1><h2 id="【分支规范】" tabindex="-1">【分支规范】 <a class="header-anchor" href="#【分支规范】" aria-hidden="true">#</a></h2><h2 id="永久分支" tabindex="-1">永久分支 <a class="header-anchor" href="#永久分支" aria-hidden="true">#</a></h2><ul><li>master：主分支只用来发布重大版本。所有提供给用户使用的正式版本，都在这个主分支上发布；</li><li>develop：日常开发应该基于此分支来完成；</li></ul><h2 id="master-devlop" tabindex="-1">Master/Devlop <a class="header-anchor" href="#master-devlop" aria-hidden="true">#</a></h2><p>Devlop 分支基于 Master 分支创建，想正式对外发布就在 Master 分支上，对 Develop 分支进行&quot;合并&quot;（merge）,并打上 tag. <img src="http://open.zantop.cn/develop.png" width="70%"></p><p>命名规范约定如下：</p><h2 id="临时分支" tabindex="-1">临时分支 <a class="header-anchor" href="#临时分支" aria-hidden="true">#</a></h2><ul><li>feature：功能开发；</li><li>release：预发布；</li><li>hotfix：修复 bug</li></ul><p>命名规范：</p><ul><li>feature 分支命名：feature/name</li><li>release 分支命名：release-name</li><li>hotfix 分支命名：hotfix/name</li></ul><h3 id="feature-功能" tabindex="-1">Feature 功能 <a class="header-anchor" href="#feature-功能" aria-hidden="true">#</a></h3><p>功能分支，它是为了开发某种特定功能，从 Develop 分支上面分出来的。开发完成后，要再并入 Develop。 <img src="http://open.zantop.cn/feature.png" width="60%"></p><h3 id="release-预发布" tabindex="-1">Release 预发布 <a class="header-anchor" href="#release-预发布" aria-hidden="true">#</a></h3><p>Release 分支基于 <code>Develop</code> 分支创建，打完 Release 分支之后，我们可以在这个 Release 分支上测试，修改 Bug 等，预发布结束以后，必须合并进 Develop 和 Master 分支。</p><p>同时，其它开发人员可以基于 Develop 分支新建 Feature (记住：一旦打了 Release 分支之后不要从 Develop 分支上合并新的改动到 Release 分支)发布 Release 分支时，合并 Release 到 Master 和 Develop， 同时在 Master 分支上打个 Tag 记住 Release 版本号，然后可以删除 Release 分支了。 <img src="http://open.zantop.cn/release.png" width="60%"></p><h3 id="hotfix-分支" tabindex="-1">Hotfix 分支 <a class="header-anchor" href="#hotfix-分支" aria-hidden="true">#</a></h3><p>hotfix 分支基于 Master 分支创建，开发完后需要合并回 Master 和 Develop 分支，同时在 Master 上打一个 tag。 <img src="http://open.zantop.cn/hotfix.png" width="60%"></p><h2 id="示例" tabindex="-1">示例 <a class="header-anchor" href="#示例" aria-hidden="true">#</a></h2><h3 id="develop-开发分支" tabindex="-1">Develop 开发分支 <a class="header-anchor" href="#develop-开发分支" aria-hidden="true">#</a></h3><div class="language-shell"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#676E95;font-style:italic;"># 从仓库 git clone master 分支 创建 develop 分支</span></span>
<span class="line"><span style="color:#FFCB6B;">git</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">clone</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">……</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"># 切换到 develop 分支:</span></span>
<span class="line"><span style="color:#FFCB6B;">git</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">checkout</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">develop</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"># 提交本地修改:</span></span>
<span class="line"><span style="color:#FFCB6B;">git</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">add</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">.</span></span>
<span class="line"><span style="color:#FFCB6B;">git</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">commit</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">–m</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">“提交日志”</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"># 推送 develop 分支:</span></span>
<span class="line"><span style="color:#FFCB6B;">git</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">push</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">origin</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">develop</span></span>
<span class="line"></span></code></pre></div><h3 id="feature-功能开发" tabindex="-1">Feature 功能开发 <a class="header-anchor" href="#feature-功能开发" aria-hidden="true">#</a></h3><p>开始 Feature 进行新功能开发</p><div class="language-shell"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#676E95;font-style:italic;"># 通过develop新建feaeure分支</span></span>
<span class="line"><span style="color:#FFCB6B;">git</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">checkout</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-b</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">feature/wz</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">develop</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;font-style:italic;"># 修改md文件</span></span>
<span class="line"><span style="color:#FFCB6B;">git</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">status</span></span>
<span class="line"><span style="color:#FFCB6B;">git</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">add</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">.</span></span>
<span class="line"><span style="color:#FFCB6B;">git</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">commit</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-m</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">feature/wz分支</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#FFCB6B;">git</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">push</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">origin</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">feature/wz</span></span>
<span class="line"></span></code></pre></div><p>完成 Feature</p><div class="language-shell"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#676E95;font-style:italic;">#切换develop分支</span></span>
<span class="line"><span style="color:#FFCB6B;">git</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">checkout</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">develop</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"># 拉下最新代码</span></span>
<span class="line"><span style="color:#FFCB6B;">git</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">pull</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">origin</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">develop</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"># 合并feature/wz到develop分支</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">#--no-ff：不使用fast-forward方式合并，保留分支的commit历史</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">#--squash：使用squash方式合并，把多次分支commit历史压缩为一次</span></span>
<span class="line"><span style="color:#FFCB6B;">git</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">merge</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">--no-ff</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">feature/wz</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"># 删除本地址feature/wz分支</span></span>
<span class="line"><span style="color:#FFCB6B;">git</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">branch</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-d</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">feature/wz</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"># 如果需要删除远程feature分支:</span></span>
<span class="line"><span style="color:#FFCB6B;">git</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">push</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">origin</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">--delete</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">feature/wz</span></span>
<span class="line"></span></code></pre></div><h3 id="release-预发布-1" tabindex="-1">Release 预发布 <a class="header-anchor" href="#release-预发布-1" aria-hidden="true">#</a></h3><p>确认 develop 分支上的功能是否开发完毕,创建 release 发布分支，测试人员可以测试了。</p><div class="language-shell"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#FFCB6B;">git</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">checkout</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-b</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">release-</span><span style="color:#F78C6C;">0.1</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">develop</span></span>
<span class="line"></span></code></pre></div><p>修复测试人员提交发 bug，不允许在该分支提交任何新功能需求。</p><div class="language-shell"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#676E95;font-style:italic;"># 修复bug</span></span>
<span class="line"><span style="color:#FFCB6B;">git</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">add</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">.</span></span>
<span class="line"><span style="color:#FFCB6B;">git</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">commit</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-m</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">已解决XXbug</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"># 推送release 分支</span></span>
<span class="line"><span style="color:#FFCB6B;">git</span><span style="color:#A6ACCD;">  </span><span style="color:#C3E88D;">push</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">origin</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">release-</span><span style="color:#F78C6C;">0.1</span></span>
<span class="line"></span></code></pre></div><p>测试无任何问题了，将 release 分支合并到 master 和 develop</p><div class="language-shell"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#FFCB6B;">git</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">checkout</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">develop</span></span>
<span class="line"><span style="color:#FFCB6B;">git</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">merge</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">--no-ff</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">release-</span><span style="color:#F78C6C;">0.1</span></span>
<span class="line"><span style="color:#FFCB6B;">git</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">push</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">origin</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">develop</span></span>
<span class="line"></span>
<span class="line"><span style="color:#FFCB6B;">git</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">checkout</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">master</span></span>
<span class="line"><span style="color:#FFCB6B;">git</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">merge</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">--no-ff</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">release-</span><span style="color:#F78C6C;">0.1</span></span>
<span class="line"><span style="color:#FFCB6B;">git</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">push</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">origin</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">master</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;font-style:italic;">#删除分支</span></span>
<span class="line"><span style="color:#FFCB6B;">git</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">branch</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-d</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">release-</span><span style="color:#F78C6C;">0.1</span></span>
<span class="line"><span style="color:#FFCB6B;">git</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">push</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">origin</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-d</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">release-</span><span style="color:#F78C6C;">0.1</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;font-style:italic;"># 合并master/devlop分支之后，打上tag</span></span>
<span class="line"><span style="color:#FFCB6B;">git</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">tag</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-a</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">v0.</span><span style="color:#F78C6C;">1.0</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">master</span></span>
<span class="line"><span style="color:#FFCB6B;">git</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">push</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">--tags</span></span>
<span class="line"></span></code></pre></div><h3 id="hotfix-修复-bug" tabindex="-1">Hotfix 修复 bug <a class="header-anchor" href="#hotfix-修复-bug" aria-hidden="true">#</a></h3><p>修复线上 bug</p><div class="language-shell"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#FFCB6B;">git</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">checkout</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-b</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">hotfix-</span><span style="color:#F78C6C;">0.1</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">master</span></span>
<span class="line"></span></code></pre></div><p>完成 bug 修复后提交到 master 和 develop</p><div class="language-shell"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#FFCB6B;">git</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">checkout</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">develop</span></span>
<span class="line"><span style="color:#FFCB6B;">git</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">merge</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">--on-of</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">hotfix-</span><span style="color:#F78C6C;">0.1</span></span>
<span class="line"><span style="color:#FFCB6B;">git</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">push</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">origin</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">develop</span></span>
<span class="line"></span>
<span class="line"><span style="color:#FFCB6B;">git</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">checkout</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">master</span></span>
<span class="line"><span style="color:#FFCB6B;">git</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">merge</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">--on-of</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">hotfix-</span><span style="color:#F78C6C;">0.1</span></span>
<span class="line"><span style="color:#FFCB6B;">git</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">push</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">origin</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">master</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;font-style:italic;">#删除分支</span></span>
<span class="line"><span style="color:#FFCB6B;">git</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">branch</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-d</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">hotfix-</span><span style="color:#F78C6C;">0.1</span></span>
<span class="line"><span style="color:#FFCB6B;">git</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">push</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">origin</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-d</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">hotfix-</span><span style="color:#F78C6C;">0.1</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"># master 上打标签</span></span>
<span class="line"><span style="color:#FFCB6B;">git</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">tag</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-a</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">v0.</span><span style="color:#F78C6C;">1</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">master</span></span>
<span class="line"><span style="color:#FFCB6B;">git</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">push</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">--tags</span></span>
<span class="line"></span></code></pre></div><p><a href="https://juejin.im/post/5d82e1f3e51d4561d044cd88" target="_blank" rel="noreferrer">gitf 分支管理规范</a></p><h2 id="【commit-规范】" tabindex="-1">【commit 规范】 <a class="header-anchor" href="#【commit-规范】" aria-hidden="true">#</a></h2><p>使用过<a href="https://github.com/angular/angular.js/blob/master/DEVELOPERS.md#commits" target="_blank" rel="noreferrer">使用 Angular 的 Commit message 格式</a></p><h3 id="husky" tabindex="-1">husky <a class="header-anchor" href="#husky" aria-hidden="true">#</a></h3><p>husky 主用功能是为 git 添加 git 钩子，它允许我们在使用 git 中在一些重要动作发生时触发自定义脚本(npm script), 比如我们可以在 git push 之前执行特定的自定义脚本对代码进行单元测试、又或者在 git commit 之前执行 eslint 校验，当然本文主要介绍如何借用 husky 为 git 添加 commit-msg 钩子并对 commit 进行校验。</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#A6ACCD;">npm install husky </span><span style="color:#89DDFF;">--</span><span style="color:#A6ACCD;">save</span><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;">dev</span></span>
<span class="line"></span></code></pre></div><p>更新 package.json</p><ul><li>添加 pre-commit 钩子，在 git commit 之前前将会在终端输出 我要提交代码啦</li><li>添加 commit-msg 钩子，在 git 校验 commit 时会在终端输出 git 所有参数和输入， husky 通过环境变量 HUSKY_GIT_PARAMS - HUSKY_GIT_STDIN 是 husky 返回 git 参数和输入</li><li>添加 pre-push 钩子， 在 git push 之前将在终端输出 提交代码前需要先进行单元测试 并执行 npm tes</li></ul><div class="language-json"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C792EA;">husky</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&quot;</span><span style="color:#FFCB6B;">hooks</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#89DDFF;">&quot;</span><span style="color:#F78C6C;">pre-commit</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">echo 我要提交代码啦</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#89DDFF;">&quot;</span><span style="color:#F78C6C;">commit-msg</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">echo $HUSKY_GIT_PARAMS $HUSKY_GIT_STDIN</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#89DDFF;">&quot;</span><span style="color:#F78C6C;">pre-push</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">echo 提交代码前需要先进行单元测试 &amp;&amp; npn test</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span></code></pre></div><h3 id="commitlint" tabindex="-1">commitlint <a class="header-anchor" href="#commitlint" aria-hidden="true">#</a></h3><p>commitlint 用于检查您的提交消息是否符合规定提交格式，一般和 husky 包一起使用，用于对 git commit 信息的格式进行校验，当 commit 信息不符合规定格式的情况下将会抛出错误。</p><p><strong>默认格式</strong></p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#A6ACCD;"># 注意：冒号前面是需要一个空格的</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> 带 ？ 表示非必填信息</span></span>
<span class="line"><span style="color:#82AAFF;">type</span><span style="color:#A6ACCD;">(scope</span><span style="color:#89DDFF;">?</span><span style="color:#A6ACCD;">)</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> subject</span></span>
<span class="line"><span style="color:#A6ACCD;">body</span><span style="color:#89DDFF;">?</span></span>
<span class="line"><span style="color:#A6ACCD;">footer</span><span style="color:#89DDFF;">?</span></span>
<span class="line"></span></code></pre></div><p>scope 指 commit 的范围（哪些模块进行了修改） subject 指 commit 的简短描述 body 指 commit 主体内容（长描述） footer 指 commit footer 信息 type 指当前 commit 类型，一般有下面几种可选类型：</p><ul><li>feat：新功能（feature）</li><li>fix：修补 bug</li><li>docs：文档修改</li><li>style： 不影响代码含义的修改(例如：white-space; 格式化等)</li><li>refactor：重构（即不是新增功能，也不是修改 bug 的代码变动）</li><li>perf: 提升性能的修改</li><li>test：增加或修改测试</li><li>chore：构建流程或辅助工具的变动</li><li>improvement: 改进</li><li>build: 打包</li><li>ci: 持续集成</li></ul><p><strong>配合 husky 包进行使用</strong></p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#A6ACCD;">npm install </span><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;">D </span><span style="color:#89DDFF;">@</span><span style="color:#A6ACCD;">commitlint</span><span style="color:#89DDFF;">/</span><span style="color:#A6ACCD;">cli </span><span style="color:#89DDFF;">@</span><span style="color:#A6ACCD;">commitlint</span><span style="color:#89DDFF;">/</span><span style="color:#A6ACCD;">config</span><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;">conventional</span></span>
<span class="line"></span></code></pre></div><p>添加 commitlint 配置文件,根目录新建文件 commitlint.config.js</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#89DDFF;">module.exports</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">extends</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> [</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">@commitlint/config-conventional</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">]</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">rules</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&#39;</span><span style="color:#F07178;">type-enum</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> [</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#F78C6C;">2</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">always</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">      [</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">feat</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">fix</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">docs</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">style</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">refactor</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">test</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">chore</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">revert</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">]</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">    ]</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&#39;</span><span style="color:#F07178;">subject-full-stop</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> [</span><span style="color:#F78C6C;">0</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">never</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">]</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&#39;</span><span style="color:#F07178;">subject-case</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> [</span><span style="color:#F78C6C;">0</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">never</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">]</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">},</span></span>
<span class="line"><span style="color:#89DDFF;">};</span></span>
<span class="line"></span></code></pre></div><p>在 package.json 中添加 husky 配置</p><div class="language-json"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">husky</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;">: </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C792EA;">hooks</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#89DDFF;">&quot;</span><span style="color:#FFCB6B;">commit-msg</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">commitlint -e $HUSKY_GIT_PARAMS</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">}</span></span>
<span class="line"></span></code></pre></div><p>这样就配好了，现在我们来测试一下,如果不加前缀会报错</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">~/</span><span style="color:#A6ACCD;">pro</span><span style="color:#89DDFF;">/</span><span style="color:#A6ACCD;">webpack</span><span style="color:#89DDFF;">/</span><span style="color:#A6ACCD;">webpack</span><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;">react   feature</span><span style="color:#89DDFF;">/</span><span style="color:#A6ACCD;">husky ✚  git commit </span><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;">m </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">修复了新bug</span><span style="color:#89DDFF;">&quot;&quot;</span></span>
<span class="line"><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#A6ACCD;">husky </span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;"> commit</span><span style="color:#89DDFF;">-</span><span style="color:#82AAFF;">msg</span><span style="color:#A6ACCD;"> (node v10</span><span style="color:#89DDFF;">.</span><span style="color:#F78C6C;">17.0</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">⧗   </span><span style="color:#FFCB6B;">input</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> 修复了新bug</span></span>
<span class="line"><span style="color:#A6ACCD;">✖   subject may not be empty [subject</span><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;">empty]</span></span>
<span class="line"><span style="color:#A6ACCD;">✖   </span><span style="color:#C792EA;">type</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">may</span><span style="color:#A6ACCD;"> not be empty [type-empty]</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">✖   found 2 problems, 0 warnings</span></span>
<span class="line"><span style="color:#A6ACCD;">ⓘ   Get help: https:</span><span style="color:#676E95;font-style:italic;">//github.com/conventional-changelog/commitlint/#what-is-commitlint</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">husky &gt; commit-msg hook failed (add --no-verify to bypass)</span></span>
<span class="line"></span></code></pre></div><p>修改后<code>git commit -m &quot;fix: 修复了 也可以直接 commit 会弹出输入界面输入</code>fix: 修复了新 bug\`就 ok。</p><h3 id="commitizen" tabindex="-1">commitizen <a class="header-anchor" href="#commitizen" aria-hidden="true">#</a></h3><p>每次提交 commit 还要手动添加校验信息很繁琐，commitizen 提供了一个交互式的, global 安装，而仅项目本地安装，方便多人开发时，减少其他人的额外操作</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#A6ACCD;">yarn add commitizen cz</span><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;">conventional</span><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;">changelog </span><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;">D</span></span>
<span class="line"></span></code></pre></div><p>在 package.json 中添加配置</p><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#A6ACCD;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">  &quot;scripts&quot;: {</span></span>
<span class="line"><span style="color:#A6ACCD;">    &quot;commit&quot;: &quot;git-cz&quot;</span></span>
<span class="line"><span style="color:#A6ACCD;">  },</span></span>
<span class="line"><span style="color:#A6ACCD;">  &quot;config&quot;: {</span></span>
<span class="line"><span style="color:#A6ACCD;">    &quot;commitizen&quot;: {</span></span>
<span class="line"><span style="color:#A6ACCD;">      &quot;path&quot;: &quot;./node_modules/cz-conventional-changelog&quot;</span></span>
<span class="line"><span style="color:#A6ACCD;">    }</span></span>
<span class="line"><span style="color:#A6ACCD;">  }</span></span>
<span class="line"><span style="color:#A6ACCD;">}</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span></code></pre></div><p>官方推荐的是 global 安装 commitizen，然后执行</p><p><code>commitizen init cz-conventional-changelog --yarn --dev --exact</code></p><p>去自动添加 cz-conventional-changelog，自动在 package.json 中添加 config 配置，不太推荐这种方式。</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;"> git cz</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">cz</span><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;">cli@</span><span style="color:#F78C6C;">4.1</span><span style="color:#89DDFF;">.</span><span style="color:#F78C6C;">2</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> cz</span><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;">conventional</span><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;">changelog@</span><span style="color:#F78C6C;">3.2</span><span style="color:#89DDFF;">.</span><span style="color:#F78C6C;">0</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">?</span><span style="color:#A6ACCD;"> Select the type </span><span style="color:#89DDFF;">of</span><span style="color:#A6ACCD;"> change that you</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">re committing: (Use arrow keys)</span></span>
<span class="line"><span style="color:#A6ACCD;">❯ feat</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;">     A </span><span style="color:#89DDFF;">new</span><span style="color:#A6ACCD;"> feature</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#FFCB6B;">fix</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;">      A bug fix</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#FFCB6B;">docs</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;">     Documentation only changes</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#FFCB6B;">style</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;">    Changes that </span><span style="color:#89DDFF;font-style:italic;">do</span><span style="color:#A6ACCD;"> not affect the meaning </span><span style="color:#89DDFF;">of</span><span style="color:#A6ACCD;"> the </span><span style="color:#82AAFF;">code</span><span style="color:#A6ACCD;"> (white</span><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;">space</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> formatting</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> missing semi</span><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;">colons</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> etc)</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#FFCB6B;">refactor</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> A code change that neither fixes a bug nor adds a feature</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#FFCB6B;">perf</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;">     A code change that improves performance</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#FFCB6B;">test</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;">     Adding missing tests or correcting existing tests</span></span>
<span class="line"><span style="color:#A6ACCD;">(Move up and down to reveal more choices)</span></span>
<span class="line"></span></code></pre></div><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#A6ACCD;">1</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">Select the </span><span style="color:#C792EA;">type</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">of</span><span style="color:#A6ACCD;"> change that you&#39;re committing 选择改动类型 (</span><span style="color:#89DDFF;">&lt;</span><span style="color:#FFCB6B;">type</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">2.What is the scope of this change (e.g. component or file name)? 填写改动范围 (</span><span style="color:#89DDFF;">&lt;</span><span style="color:#FFCB6B;">scope</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">3.Write a short, imperative tense description of the change: 写一个精简的描述 (</span><span style="color:#89DDFF;">&lt;</span><span style="color:#FFCB6B;">subject</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">4.Provide a longer description of the change: (press enter to skip) 对于改动写一段长描述 (</span><span style="color:#89DDFF;">&lt;</span><span style="color:#FFCB6B;">body</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">5.Are there any breaking changes? (y/n) 是破坏性修改吗？默认n (</span><span style="color:#89DDFF;">&lt;</span><span style="color:#FFCB6B;">footer</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">6.Does this change affect any openreve issues? (y/n) 改动修复了哪个问题？默认n (</span><span style="color:#89DDFF;">&lt;</span><span style="color:#FFCB6B;">footer</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"></span></code></pre></div><p><a href="https://blog.csdn.net/youanyyou/article/details/103415164" target="_blank" rel="noreferrer">别乱提交代码了，看下大厂 Git 提交规范是怎么做的！</a></p><h3 id="提交中支持表情符号" tabindex="-1">提交中支持表情符号 <a class="header-anchor" href="#提交中支持表情符号" aria-hidden="true">#</a></h3><p>借助<a href="https://github.com/carloscuesta/gitmoji-cli" target="_blank" rel="noreferrer">gitmoji-cli</a></p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#A6ACCD;">yarn add gitmoji</span><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;">cli </span><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;">D</span></span>
<span class="line"></span></code></pre></div><p>使用方法：在提交时按照约定格式输入表情字符即可（左右两边英文冒号夹着字符，例如 bug ☞ 🐛），提交后会自动被显示，示例：</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#A6ACCD;">git commit </span><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;">m </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">fix(src): :bug: 修复列表显示问题</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"></span></code></pre></div><p>如果想要查看所有的表情符号及介绍，可以去<a href="https://gitmoji.carloscuesta.me/" target="_blank" rel="noreferrer">官方文档查阅</a>，也可以全局安装 <code>npm i -g gitmoji-cli</code> 执行 gitmoji -l 命令在终端查看。</p><h3 id="自动生成-changelog" tabindex="-1">自动生成 changelog <a class="header-anchor" href="#自动生成-changelog" aria-hidden="true">#</a></h3><p>在使用上文 commit 规范的情况下， 可以通过 standard-version 自动生成 change log，并更新项目的版本信息添加 git tag, change log 中将收录所有 type 为 feat 和 fix 的 commit</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#A6ACCD;">npm i </span><span style="color:#89DDFF;">--</span><span style="color:#A6ACCD;">save</span><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;">dev standard</span><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;">version</span></span>
<span class="line"></span></code></pre></div><p>npm 脚本命令</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">scripts</span><span style="color:#89DDFF;">&quot;</span><span style="color:#F07178;">: </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">+   </span><span style="color:#89DDFF;">&quot;</span><span style="color:#F07178;">release</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">standard-version</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span></code></pre></div><p>切换 master 分支<code>git checkout master</code>,拉取远程代码<code>git pull origin master</code> 首次发布运行<code>npm run release -- --first-release</code>生成<code>CHANGELOG.md</code></p><p><strong>-- pre-release, -p 预发版本命令</strong></p><p>使用--prerelease 或者-p 来生成预发布： 假设当前版本是 1.0.0，且将要 commit 的代码为打补丁的修改。运行：</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#A6ACCD;">npm run release </span><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;">p alpha</span></span>
<span class="line"></span></code></pre></div><p>这个 tag 将是 1.0.1-alpha.0</p><p><strong>--release-as, -r 指定版本号</strong></p><p>默认情况下，工具会自动根据 主版本（major）,次版本（ minor） or 修订版（patch） 规则生成版本号，例如如果你 package.json 中的 version 为 1.0.0, 那么执行后版本号则是：1.0.1。自定义可以通过：</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#A6ACCD;">npm run release </span><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;">r </span><span style="color:#F78C6C;">1.0</span><span style="color:#89DDFF;">.</span><span style="color:#F78C6C;">1</span></span>
<span class="line"></span></code></pre></div><p>将生成版本号 1.1.0,而不是自动生成的版本号 1.0.1</p><p>更新本地 tag 到远程分支</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#A6ACCD;">git push </span><span style="color:#89DDFF;">--</span><span style="color:#A6ACCD;">follow</span><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;">tags origin master</span></span>
<span class="line"></span></code></pre></div><p>自定义头部 <a href="http://CAGNGELOG.md" target="_blank" rel="noreferrer">CAGNGELOG.md</a> 根目录创建<code>.versionrc</code></p><div class="language-json"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C792EA;">header</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">This header is not used</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span></code></pre></div><p><a href="https://juejin.im/post/5d05ef596fb9a07ef63fdbe7#heading-4" target="_blank" rel="noreferrer">git 工作流和 git commit 规范</a><br><a href="https://juejin.im/post/5cf150f1f265da1b7c60ffe3#heading-0" target="_blank" rel="noreferrer">git commit 规范校验配置和版本发布配置</a></p><h2 id="git-命令" tabindex="-1">git 命令 <a class="header-anchor" href="#git-命令" aria-hidden="true">#</a></h2><h3 id="关联远程分支" tabindex="-1">关联远程分支 <a class="header-anchor" href="#关联远程分支" aria-hidden="true">#</a></h3><div class="language-shell"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#FFCB6B;">git</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">remote</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">add</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">origin</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">远程仓库地址</span></span>
<span class="line"></span></code></pre></div><h3 id="设置远程分支" tabindex="-1">设置远程分支 <a class="header-anchor" href="#设置远程分支" aria-hidden="true">#</a></h3><div class="language-shell"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#FFCB6B;">git</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">push</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">--set-upstream</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">origin</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">develop</span></span>
<span class="line"><span style="color:#FFCB6B;">git</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">push</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-u</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">origin</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">develop</span></span>
<span class="line"></span></code></pre></div><h3 id="查看分支" tabindex="-1">查看分支 <a class="header-anchor" href="#查看分支" aria-hidden="true">#</a></h3><div class="language-shell"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#676E95;font-style:italic;"># 查看本地分支</span></span>
<span class="line"><span style="color:#FFCB6B;">git</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">branch</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"># 查看远程分支</span></span>
<span class="line"><span style="color:#FFCB6B;">git</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">branch</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-r</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"># 查看所有分支</span></span>
<span class="line"><span style="color:#FFCB6B;">git</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">branch</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-a</span></span>
<span class="line"></span></code></pre></div><h3 id="删除远程分支" tabindex="-1">删除远程分支 <a class="header-anchor" href="#删除远程分支" aria-hidden="true">#</a></h3><div class="language-shell"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#FFCB6B;">git</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">push</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">origin</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-d</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">分支</span></span>
<span class="line"></span></code></pre></div><h3 id="拉取指定分支代码" tabindex="-1">拉取指定分支代码 <a class="header-anchor" href="#拉取指定分支代码" aria-hidden="true">#</a></h3><div class="language-shell"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#FFCB6B;">git</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">clone</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-b</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">dev_jk</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">http://aaa/bbb.git</span></span>
<span class="line"></span></code></pre></div><h3 id="查看远程分支" tabindex="-1">查看远程分支 <a class="header-anchor" href="#查看远程分支" aria-hidden="true">#</a></h3><div class="language-shell"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#FFCB6B;">git</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">remote</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-v</span><span style="color:#A6ACCD;"> </span></span>
<span class="line"></span>
<span class="line"></span></code></pre></div><h3 id="查看日志" tabindex="-1">查看日志 <a class="header-anchor" href="#查看日志" aria-hidden="true">#</a></h3><div class="language-shell"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#676E95;font-style:italic;"># 显示所有提交过的版本信息</span></span>
<span class="line"><span style="color:#FFCB6B;">git</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">log</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"># 只显示版本号和提交时的备注信息</span></span>
<span class="line"><span style="color:#FFCB6B;">git</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">log</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">--pretty=oneline</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"># 显示短版本号</span></span>
<span class="line"><span style="color:#FFCB6B;">git</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">log</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">--oneline</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"># 查看所有分支的所有操作记录（包括已经被删除的 commit 记录和 reset 的操作）</span></span>
<span class="line"><span style="color:#FFCB6B;">git</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">reflog</span></span>
<span class="line"></span></code></pre></div><h3 id="撤销操作" tabindex="-1">撤销操作 <a class="header-anchor" href="#撤销操作" aria-hidden="true">#</a></h3><p><strong>工作区</strong></p><div class="language-shell"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#676E95;font-style:italic;"># 撤销单个文件更改</span></span>
<span class="line"><span style="color:#FFCB6B;">git</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">checkout</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">文件名</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"># 撤销所有操作</span></span>
<span class="line"><span style="color:#FFCB6B;">git</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">checkout</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">.</span></span>
<span class="line"></span></code></pre></div><p><strong>暂存区与版本库HEAD区</strong></p><p>git reset 会撤掉改commit_id之后所有版本</p><div class="language-shell"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#676E95;font-style:italic;"># 使用reset默认的--fixed参数，假装回退到当前版本，撤销add</span></span>
<span class="line"><span style="color:#FFCB6B;">git</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">reset</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">HEAD</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;font-style:italic;"># reset 有三个参数</span></span>
<span class="line"><span style="color:#FFCB6B;">--fixed</span><span style="color:#A6ACCD;"> 					</span><span style="color:#676E95;font-style:italic;"># 默认，不删除工作空间改动代码，撤销commit，撤销add</span></span>
<span class="line"><span style="color:#FFCB6B;">--soft</span><span style="color:#A6ACCD;">						</span><span style="color:#676E95;font-style:italic;"># 不删除工作空间改动代码，撤销commit，不撤销add</span></span>
<span class="line"><span style="color:#FFCB6B;">--hard</span><span style="color:#A6ACCD;">						</span><span style="color:#676E95;font-style:italic;"># 删除工作空间改动代码，撤销commit，不撤销add</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;font-style:italic;"># 也撤销指定文件的add</span></span>
<span class="line"><span style="color:#FFCB6B;">git</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">reset</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">HEAD</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">fileName.txt</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"># 退回到某次commit</span></span>
<span class="line"><span style="color:#FFCB6B;">git</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">reset</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">--hard</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">HEAD^</span><span style="color:#A6ACCD;">         </span><span style="color:#676E95;font-style:italic;"># 回退到上个版本</span></span>
<span class="line"><span style="color:#FFCB6B;">git</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">reset</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">--hard</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">HEAD~</span><span style="color:#F78C6C;">3</span><span style="color:#A6ACCD;">        </span><span style="color:#676E95;font-style:italic;"># 回退到前3次提交之前，以此类推，回退到n次提交之前</span></span>
<span class="line"><span style="color:#FFCB6B;">git</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">reset</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">--hard</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">commit_id</span><span style="color:#A6ACCD;">     </span><span style="color:#676E95;font-style:italic;"># 退到/进到 指定commit的sha码</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;font-style:italic;"># 需要强制提交</span></span>
<span class="line"><span style="color:#FFCB6B;">git</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">push</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-f</span></span>
<span class="line"></span></code></pre></div><p>git revert 撤销某个版本的提交</p><div class="language-shell"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#676E95;font-style:italic;"># 撤销&lt;commit-hash&gt;这个版本的操作</span></span>
<span class="line"><span style="color:#FFCB6B;">git</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">revert</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">-n</span><span style="color:#89DDFF;">]</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&lt;</span><span style="color:#C3E88D;">commit-has</span><span style="color:#A6ACCD;">h</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"># 默认需要立刻commit，可以添加-n或--no-commit参数推迟commit</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"># 接下来直接commit、push即可，会在log中追加新的commit记录</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;font-style:italic;"># 连续多个revert</span></span>
<span class="line"><span style="color:#FFCB6B;">git</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">revert</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-n</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&lt;</span><span style="color:#C3E88D;">commit-hash_star</span><span style="color:#A6ACCD;">t</span><span style="color:#89DDFF;">&gt;</span><span style="color:#C3E88D;">..</span><span style="color:#89DDFF;">&lt;</span><span style="color:#C3E88D;">commit-hash_en</span><span style="color:#A6ACCD;">d</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">	</span><span style="color:#676E95;font-style:italic;"># 会撤销（ commit-hash_start, commit-hash_end ] 的提交</span></span>
<span class="line"></span></code></pre></div><div class="language-shell"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#676E95;font-style:italic;"># 撤销该提交</span></span>
<span class="line"><span style="color:#FFCB6B;">git</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">revert</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-n</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">e0e19f0079e1e1b1d26262bbe3ea2530a701592d</span><span style="color:#A6ACCD;">   </span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"># 在commit下生成个新版本</span></span>
<span class="line"><span style="color:#FFCB6B;">git</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">commit</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-m</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">提交代码新</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"></span></code></pre></div><p><a href="https://blog.csdn.net/yxlshk/article/details/79944535" target="_blank" rel="noreferrer">git恢复之前版本的两种方法reset、revert</a></p><p><a href="https://juejin.im/post/6844904121133170696" target="_blank" rel="noreferrer">git详解</a></p><p><a href="https://juejin.im/post/6869519303864123399" target="_blank" rel="noreferrer">「一劳永逸」一张脑图带你掌握Git命令</a></p><p><img src="http://open.zantop.cn/git%E5%91%BD%E4%BB%A4.png" alt=""></p>`,126),o=[e];function t(c,r,i,C,y,D){return n(),a("div",null,o)}const d=s(p,[["render",t]]);export{F as __pageData,d as default};
